(this["webpackJsonpphaser-3-react-platformer"]=this["webpackJsonpphaser-3-react-platformer"]||[]).push([[0],{1483:function(e,s,t){"use strict";t.r(s);var i=t(40),a=t.n(i),n=t(557),o=t.n(n),r=(t(563),t(564),t(74)),h=t(75),c=t(76),l=t(77),d=t(63),u=t.n(d),y=t(35),m=function(e){Object(l.a)(t,e);var s=Object(c.a)(t);function t(e){var i;return Object(r.a)(this,t),(i=s.call(this,e.scene,e.x,e.y,e.key,e.frame)).sprite=void 0,i.body=void 0,i.currentScene=void 0,i.isFrozen=!1,i.isAlive=!0,i.SPEED=200,i.JUMP_SPEED=600,i.BOUNCE_SPEED=200,i.currentScene=e.scene,i.currentScene.physics.add.existing(Object(y.a)(i)),i.currentScene.physics.world.enable(Object(y.a)(i)),i.currentScene.add.existing(Object(y.a)(i)),i.body.setCollideWorldBounds(!0),i.setFlipX(!1),i.setOrigin(0,.5),i.body.setOffset(3,10),i.currentScene.events.on("update",(function(){i.body&&i.update()})),i.on("animationcomplete",(function(e){"die"===e.key&&this.destroy()}),Object(y.a)(i)),i.createAnims(i.currentScene),i}return Object(h.a)(t,[{key:"update",value:function(){this.currentScene.cursors.left.isDown?this.moveLeft():this.currentScene.cursors.right.isDown?this.moveRight():this.stand(),this.currentScene.cursors.up.isDown&&this.jump(),this.body.velocity.y>0&&this.anims.play("fall",!0)}},{key:"moveLeft",value:function(){this.isFrozen||(this.body.setVelocityX(-this.SPEED),0!==this.body.velocity.x&&0===this.body.velocity.y&&this.anims.play("run",!0),this.flipX=!0)}},{key:"moveRight",value:function(){this.isFrozen||(this.body.setVelocityX(this.SPEED),0!==this.body.velocity.x&&0===this.body.velocity.y&&this.anims.play("run",!0),this.flipX=!1)}},{key:"stand",value:function(){this.body.setVelocityX(0),0===this.body.velocity.x&&0===this.body.velocity.y&&this.body.touching.down&&this.anims.play("stop",!0)}},{key:"jump",value:function(){var e=this.body.touching.down&&this.isAlive&&!this.isFrozen;return e&&(this.body.setVelocityY(-this.JUMP_SPEED),this.anims.play("jump",!0),this.currentScene.sfx.jump.play()),e}},{key:"bounce",value:function(){this.body.setVelocityY(-this.BOUNCE_SPEED)}},{key:"freeze",value:function(){this.body.enable=!1,this.anims.play("stop",!0),this.isFrozen=!0}},{key:"die",value:function(){this.isAlive=!1,this.body.enable=!1,this.anims.play("die")}},{key:"createAnims",value:function(e){e.anims.create({key:"stop",frames:e.anims.generateFrameNumbers("hero",{frames:[0]})}),e.anims.create({key:"run",frames:e.anims.generateFrameNumbers("hero",{frames:[1,2]}),frameRate:8,repeat:-1}),e.anims.create({key:"jump",frames:e.anims.generateFrameNumbers("hero",{frames:[3]})}),e.anims.create({key:"fall",frames:e.anims.generateFrameNumbers("hero",{frames:[4]})})}}]),t}(u.a.GameObjects.Sprite),p=function(e){Object(l.a)(t,e);var s=Object(c.a)(t);function t(e){var i;return Object(r.a)(this,t),(i=s.call(this,e.scene,e.x,e.y,e.key,e.frame)).sprite=void 0,i.currentScene=void 0,i.SPEED=100,i.currentScene=e.scene,i.setOrigin(.5),i.scene.add.existing(Object(y.a)(i)),i.scene.physics.add.existing(Object(y.a)(i)),i.scene.physics.world.enable(Object(y.a)(i)),i.setCollideWorldBounds(!0),i.setVelocityX(i.SPEED),i.scene.events.on("update",(function(){i.body&&i.update()})),i.on("animationcomplete",(function(e){"die"===e.key&&this.destroy()}),Object(y.a)(i)),i.createAnims(i.currentScene),i.anims.play("crawl",!0),i}return Object(h.a)(t,[{key:"update",value:function(){this.body.touching.right||this.body.blocked.right?this.setVelocityX(-this.SPEED):(this.body.touching.left||this.body.blocked.left)&&this.setVelocityX(this.SPEED)}},{key:"die",value:function(){this.body.enable=!1,this.scene.anims.play("die",this)}},{key:"createAnims",value:function(e){e.anims.create({key:"crawl",frames:e.anims.generateFrameNumbers("spider",{frames:[0,1,2]}),frameRate:8,repeat:-1}),e.anims.create({key:"die",frames:e.anims.generateFrameNumbers("spider",{frames:[0,4,0,4,0,4,3,3,3,3,3,3]}),frameRate:12})}}]),t}(u.a.Physics.Arcade.Sprite),f=function(e){Object(l.a)(t,e);var s=Object(c.a)(t);function t(){var e;return Object(r.a)(this,t),(e=s.call(this,"PlayScene")).cursors=null,e.coinPickupCount=null,e.hasKey=null,e.level=null,e.sfx=null,e.coinFont=null,e.keyIcon=null,e.hud=null,e.platforms=null,e.enemyWalls=null,e.bgDecorations=null,e.door=null,e.coins=null,e.hero=null,e.spiders=null,e.key=null,e}return Object(h.a)(t,[{key:"init",value:function(e){this.cursors=this.input.keyboard.createCursorKeys(),this.coinPickupCount=0,this.hasKey=!1,this.level=(e.level||0)%2,this.cameras.main.setRoundPixels(!0)}},{key:"preload",value:function(){var e;(e=this).load.image("background","./assets/phaser/images/background.png"),e.load.image("ground","./assets/phaser/images/ground.png"),e.load.image("grass:8x1","./assets/phaser/images/grass_8x1.png"),e.load.image("grass:6x1","./assets/phaser/images/grass_6x1.png"),e.load.image("grass:4x1","./assets/phaser/images/grass_4x1.png"),e.load.image("grass:2x1","./assets/phaser/images/grass_2x1.png"),e.load.image("grass:1x1","./assets/phaser/images/grass_1x1.png"),e.load.image("invisible-wall","./assets/phaser/images/invisible_wall.png"),e.load.image("icon:coin","./assets/phaser/images/coin_icon.png"),e.load.image("font:numbers","./assets/phaser/images/numbers.png"),e.load.image("key","./assets/phaser/images/key.png"),function(e){e.load.spritesheet("coin","./assets/phaser/images/coin_animated.png",{frameWidth:22,frameHeight:22}),e.load.spritesheet("spider","./assets/phaser/images/spider.png",{frameWidth:42,frameHeight:32}),e.load.spritesheet("hero","./assets/phaser/images/hero.png",{frameWidth:36,frameHeight:42}),e.load.spritesheet("door","./assets/phaser/images/door.png",{frameWidth:42,frameHeight:66}),e.load.spritesheet("icon:key","./assets/phaser/images/key_icon.png",{frameWidth:34,frameHeight:30}),e.load.spritesheet("decoration","./assets/phaser/images/decor.png",{frameWidth:42,frameHeight:42})}(this),function(e){e.load.audio("sfx:jump","./assets/phaser/audio/jump.wav"),e.load.audio("sfx:coin","./assets/phaser/audio/coin.wav"),e.load.audio("sfx:stomp","./assets/phaser/audio/stomp.wav"),e.load.audio("sfx:key","./assets/phaser/audio/key.wav"),e.load.audio("sfx:door","./assets/phaser/audio/door.wav"),e.load.audio("bgm",["./assets/phaser/audio/bgm.mp3","./assets/phaser/audio/bgm.ogg"])}(this),function(e){e.load.json("level:0","./assets/phaser/data/level00.json"),e.load.json("level:1","./assets/phaser/data/level01.json")}(this)}},{key:"create",value:function(){var e;this.cameras.main.flash(),this.add.image(0,0,"background").setOrigin(0).setScale(1.2),this.loadLevel(this.cache.json.get("level:".concat(this.level))),this.sfx={key:(e=this).sound.add("sfx:key"),door:e.sound.add("sfx:door"),jump:e.sound.add("sfx:jump"),coin:e.sound.add("sfx:coin"),stomp:e.sound.add("sfx:stomp"),bgm:e.sound.add("bgm")},this.sfx.bgm.setLoop(!0),this.sfx.bgm.play(),this.createHud()}},{key:"update",value:function(){this.handleCollisions(),this.coinFont.text="x".concat(this.coinPickupCount),this.keyIcon.setFrame(this.hasKey?1:0)}},{key:"loadLevel",value:function(e){var s=this;this.platforms=this.add.group(),this.enemyWalls=this.add.group(),this.bgDecorations=this.add.group(),this.coins=this.add.group(),this.spiders=this.add.group(),e.decoration.forEach((function(e){s.bgDecorations.add(s.add.image(e.x,e.y,"decoration",e.frame).setOrigin(0,0))})),e.platforms.forEach((function(e){return s.spawnPlatform(e)})),e.coins.forEach((function(e){return s.spawnCoin(e)})),this.spawnDoor(e.door.x,e.door.y),this.spawnKey(e.key.x,e.key.y),this.spawnCharacters({hero:e.hero,spiders:e.spiders})}},{key:"spawnPlatform",value:function(e){var s=this.platforms.create(e.x,e.y,e.image).setOrigin(0,0);this.physics.world.enable(s),s.body.allowGravity=!1,s.body.immovable=!0,this.spawnEnemyWall(e.x,e.y,"left"),this.spawnEnemyWall(e.x+s.width,e.y,"right")}},{key:"spawnEnemyWall",value:function(e,s,t){var i=this.enemyWalls.create(e,s,"invisible-wall").setOrigin("left"===t?1:0,1);this.physics.world.enable(i),i.body.setImmovable(!0),i.body.setAllowGravity(!1),i.visible=!1}},{key:"spawnCoin",value:function(e){var s=this.coins.create(e.x,e.y,"coin").setOrigin(.5,.75);this.anims.create({key:"rotate",frames:this.anims.generateFrameNumbers("coin",{frames:[0,1,2,1]}),frameRate:6,repeat:-1}),this.anims.play("rotate",s),this.physics.world.enable(s),s.body.setAllowGravity(!1)}},{key:"spawnDoor",value:function(e,s){this.door=this.bgDecorations.create(e,s,"door").setOrigin(.5,1),this.physics.world.enable(this.door),this.door.body.setAllowGravity(!1)}},{key:"spawnKey",value:function(e,s){this.key=this.bgDecorations.create(e,s,"key").setOrigin(.5,.5),this.physics.world.enable(this.key),this.key.body.setAllowGravity(!1),this.key.y-=3,this.tweens.add({targets:this.key,y:this.key.y+6,ease:"Sine.easeInOut",duration:800,yoyo:!0,repeat:-1})}},{key:"spawnCharacters",value:function(e){var s=this;this.hero=new m({scene:this,x:e.hero.x,y:e.hero.y}),e.spiders.forEach((function(e){var t=new p({scene:s,x:e.x,y:e.y});s.spiders.add(t)}))}},{key:"createHud",value:function(){var e={image:"font:numbers",width:19,height:26,chars:"0123456789X ",charsPerRow:10,"offset.x":0,"offset.y":0,"spacing.x":1,"spacing.y":1,lineSpacing:0};this.cache.bitmapFont.add("font:numbers",Phaser.GameObjects.RetroFont.Parse(this,e)),this.keyIcon=this.make.image({x:10,y:29,key:"icon:key"}).setOrigin(0,.5);var s=this.make.image({x:10+this.keyIcon.width+7,y:10,key:"icon:coin"}).setOrigin(0,0);this.coinFont=this.add.bitmapText(10+s.x+s.width,10+s.height/2,"font:numbers").setOrigin(0,.5)}},{key:"handleCollisions",value:function(){var e=this;this.physics.add.collider(this.hero,this.platforms),this.physics.add.collider(this.spiders,this.platforms),this.physics.add.collider(this.spiders,this.enemyWalls),this.physics.add.overlap(this.hero,this.coins,this.onHeroVsCoin,null,this),this.physics.add.overlap(this.hero,this.spiders,this.onHeroVsEnemy,null,this),this.physics.add.overlap(this.hero,this.key,this.onHeroVsKey,null,this),this.physics.add.overlap(this.hero,this.door,this.onHeroVsDoor,(function(s){return e.hasKey&&s.body.touching.down}),this)}},{key:"onHeroVsCoin",value:function(e,s){this.sfx.coin.play(),this.coins.killAndHide(s),s.body.enable=!1,this.coinPickupCount++}},{key:"onHeroVsEnemy",value:function(e,s){e.body.velocity.y>0?(e.bounce(),s.die(),this.sfx.stomp.play()):(this.sfx.stomp.play(),this.scene.restart())}},{key:"onHeroVsKey",value:function(e,s){this.sfx.key.play(),this.bgDecorations.killAndHide(s),s.body.enable=!1,this.hasKey=!0}},{key:"onHeroVsDoor",value:function(e,s){var t=this;s.setFrame(1),this.sfx.door.play(),e.freeze(),this.tweens.add({targets:e,x:this.door.x,alpha:0,duration:500,ease:null,autoStart:!0,onComplete:function(){t.cameras.main.fade(1e3,0,0,0,!1,(function(){t.sfx.bgm.stop(),t.scene.restart({level:t.level+1})}))}})}}]),t}(d.Scene),g=function(e){Object(l.a)(t,e);var s=Object(c.a)(t);function t(){return Object(r.a)(this,t),s.apply(this,arguments)}return Object(h.a)(t,[{key:"componentDidMount",value:function(){var e={type:u.a.AUTO,width:960,height:630,parent:"phaser-game",scene:[f],physics:{default:"arcade",arcade:{gravity:{y:1200},debug:!1}}};new u.a.Game(e)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return a.a.createElement("div",{id:"phaser-game"})}}]),t}(a.a.Component),b=function(){return a.a.createElement(g,null)};var v=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(b,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},558:function(e,s,t){e.exports=t(1483)},563:function(e,s,t){},564:function(e,s,t){}},[[558,1,2]]]);
//# sourceMappingURL=main.9b181d23.chunk.js.map